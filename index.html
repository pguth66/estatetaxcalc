<!DOCTYPE html>
<html lang="en">
<head>
<title>Calculate your estate tax</title>
<link rel="stylesheet" href="css/w3.css">
<link rel="stylesheet" href="css/w3-theme-black.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
</head>
<body>

<header class="w3-container w3-theme w3-padding" id="myHeader">
<div class="w3-center">
<h1 class="w3-xxxlarge">How much will I pay in estate tax?</h1>
</div>
</header>

<div class="w3-padding w3-white w3-center">
<p>
Please type in the estimated value of your estate, in dollars, then hit the button.
</p>

<input id="networth" type="number" min="0" max="10000000000" step="100000" required>

<button type="button" onclick="estateTaxOwed()">Show me my tax!</button>

<p id="demo"> </p>
</div>
<div class="w3-container">
<div id="tableholder" class="w3-responsive w3-card-4">
</div>
</div>
<script src="js/accounting.js">
</script>
<script src="js/drawtable.js">
</script>
<script>
function estateTaxOwed() {

	var limit = 5450000; // 2016 limit
	var x , text ;
	var tax = 0, adjustedEstateValue = 0 ;
	var effectiveRate = 0 ;
	accounting.settings.currency.precision=0 ;

	var estateValue = document.getElementById("networth").value;

	// clear this in case someone entered a number below the threshold and now enters one over
	document.getElementById("demo").innerHTML="";

	try {
		if(isNaN(estateValue)) throw "Please enter a number.";
		if(estateValue < 0) throw "Can't have negative estate value.";
		if(estateValue > 10000000000) throw "You can't have that much money!";

		adjustedEstateValue = estateValue - limit ;

		if (adjustedEstateValue  < 0 ) {
			remainingEstate = estateValue ;
			adjustedEstateValue = 0 ;
			console.log("value of effectiveRate is " + effectiveRate);
			drawTable(estateValue, tax, effectiveRate, adjustedEstateValue, remainingEstate);
			document.getElementById("demo").innerHTML = "You will owe <strong>no</strong> estate tax.";
		} else {
			tax = adjustedEstateValue * 0.4 ;
			effectiveRate = (tax / estateValue)  * 100;
			remainingEstate = estateValue - tax ;
			drawTable(estateValue, tax, effectiveRate, adjustedEstateValue, remainingEstate);
		}
	}
	catch(err) {
		console.log(err);
		text = err ; 
	}

}

</script>
</html>

